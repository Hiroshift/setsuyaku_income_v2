<% if user_signed_in? %>

  <div class="record">
    <p class="record-q">いくら節約しましたか？</p>
    <%= form_with url: new_income_path, method: :post, local: true do |f| %>
      <div class="record-input-wrap">
        <span class="record-yen">¥</span>
        <%= f.number_field :amount, placeholder: "0", class: "record-input", required: true, min: 1, inputmode: "numeric", autocomplete: "off" %>
      </div>
      <%= f.submit "収入に変換する", class: "record-btn" %>
    <% end %>
  </div>

  <hr class="sep">

  <div class="today">
    <div class="today-item">
      <span class="today-num">¥<%= number_with_delimiter(@today_income) %></span>
      <span class="today-sub">今日の節約収入</span>
    </div>
    <div class="today-item">
      <span class="today-num"><%= @virtual_work_time %></span>
      <span class="today-sub">取り戻した時間</span>
    </div>
  </div>

  <% if @lifetime_minutes > 0 %>
    <hr class="sep">

    <div class="life">
      <p class="life-above">取り戻した人生</p>
      <p class="life-num"><%= @lifetime_display %></p>
      <p class="life-below">
        累計 ¥<%= number_with_delimiter(@total_income) %><% if @annual_projection.present? %> · 年末まで<%= @annual_projection %>ペース<% end %>
      </p>
    </div>

    <% if @total_minutes > 0 %>
      <%= turbo_frame_tag "ai_suggestion" do %>
        <%= button_to "この時間の使い方をAIに聞く →", suggest_path,
              class: "ai-text-link",
              data: { turbo_frame: "ai_suggestion" } %>
      <% end %>
    <% end %>
  <% else %>
    <hr class="sep">

    <div class="life">
      <p class="life-above">累計の節約収入</p>
      <p class="life-num life-num--plain">¥<%= number_with_delimiter(@total_income) %></p>
    </div>
  <% end %>

<% else %>

  <div class="hero">
    <p class="hero-kicker">節約は、</p>
    <h2 class="hero-big">収入だ。</h2>
    <p class="hero-body">
      節約した金額を「収入」と「取り戻した時間」に変換。
      毎日の小さな節約が、どれだけの価値か実感できます。
    </p>

    <div class="hero-ex">
      <p class="hero-ex-line">コンビニ弁当を自炊に変えて ¥500 節約</p>
      <p class="hero-ex-line hero-ex-strong">→ ¥500 の収入、25分の自由を取り戻した</p>
    </div>

    <%= link_to "無料ではじめる", new_user_registration_path, class: "hero-cta" %>

    <ul class="hero-notes">
      <li>節約金額をサッと記録</li>
      <li>あなたの時給で「時間」に変換</li>
      <li>取り戻した人生を可視化</li>
    </ul>
  </div>

<% end %>
